{% extends "staff/base_staff.html" %}
{% block staff_title %}Staff — Événement : {{ event.title }}{% endblock %}

{% block staff_content %}
<section class="space-y-6">
  <!-- Header -->
  <header class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-extrabold text-blue-700 dark:text-blue-300">{{ event.title }}</h1>
      <p class="text-slate-600 dark:text-slate-400">
        {{ event.date|date:"Y-m-d" }} · {{ event.location|default:"Lieu à confirmer" }}
      </p>
      {% if projects %}
        <p class="text-sm text-slate-600 dark:text-slate-400">
          Projets : {{ projects|join:", " }}
        </p>
      {% endif %}
    </div>

    <div class="flex gap-2">
      <a href="{% url 'staff:event_update' event.id %}"
         class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700
                focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600/60">
        Éditer
      </a>
      <a href="{% url 'staff:events_list' %}"
         class="px-4 py-2 rounded-lg ring-1 ring-slate-200 hover:bg-slate-50
                dark:ring-white/10 dark:hover:bg-white/5">
        Retour
      </a>
    </div>
  </header>

  <!-- Description -->
  <article class="bg-white dark:bg-slate-900 rounded-2xl shadow ring-1 ring-black/5 dark:ring-white/10 p-6">
    <h2 class="text-lg font-semibold mb-3 text-slate-900 dark:text-slate-100">Description</h2>
    <p class="whitespace-pre-line text-slate-800 dark:text-slate-200">
      {{ event.description|default:"(Aucune description)" }}
    </p>
    {% if event.image %}
      <img src="{{ event.image.url }}" alt="{{ event.title }}"
           class="mt-4 rounded-xl max-h-72 w-full object-cover ring-1 ring-black/5 dark:ring-white/10">
    {% endif %}
  </article>

  <!-- Missions liées -->
  <section class="bg-white dark:bg-slate-900 rounded-2xl shadow ring-1 ring-black/5 dark:ring-white/10 p-6">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100">
        Missions liées ({{ missions|length }})
      </h2>
      <a href="{% url 'staff:mission_create' %}?event={{ event.id }}"
         class="px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700
                focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600/60">
        Créer une mission liée
      </a>
    </div>

    <ul class="divide-y divide-slate-200 dark:divide-white/10">
      {% for m in missions %}
        <li class="py-3 flex items-center justify-between">
          <div class="min-w-0">
            <p class="font-medium text-slate-900 dark:text-slate-100 truncate">{{ m.title }}</p>
            <p class="text-xs text-slate-600 dark:text-slate-400">
              {% if m.start_date %}{{ m.start_date|date:"Y-m-d H:i" }}{% else %}Date à confirmer{% endif %}
              · {{ m.location|default:"Lieu à confirmer" }}
            </p>
          </div>
          <div class="flex gap-2">
            <a href="{% url 'staff:mission_detail' m.id %}"
               class="text-blue-600 dark:text-blue-300 hover:underline">Détails mission</a>
            <a href="{% url 'staff:mission_invite' m.id %}"
               class="text-slate-600 dark:text-slate-300 hover:underline">Inviter</a>
          </div>
        </li>
      {% empty %}
        <li class="py-3 text-sm text-slate-500 dark:text-slate-400">Aucune mission liée.</li>
      {% endfor %}
    </ul>
  </section>
</section>
{% endblock %}
