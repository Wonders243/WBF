{% extends "staff/base_staff.html" %}
{% block staff_title %}Staff — Équipe{% endblock %}

{% block staff_content %}
<header class="mb-4 flex items-center justify-between">
  <h1 class="text-2xl font-extrabold text-blue-700 dark:text-blue-300">Équipe</h1>
  <div class="relative">
    {% if request.user.is_superuser %}
    <details class="group">
      <summary class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 cursor-pointer select-none">
        Ajouter
      </summary>
      <div class="absolute right-0 mt-2 w-56 bg-white dark:bg-slate-900 rounded-xl shadow ring-1 ring-black/5 dark:ring-white/10 p-2 z-10">
        <a href="{% url 'staff:team_invite_picker' %}" class="block px-3 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-white/5">Inviter des bénévoles</a>
        <a href="{% url 'staff:team_create' %}" class="block px-3 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-white/5">Créer manuellement</a>
      </div>
    </details>
    {% endif %}
  </div>
</header>

<form method="get"
      class="bg-white dark:bg-slate-900 rounded-2xl shadow ring-1 ring-black/5 dark:ring-white/10 p-4 mb-4 grid grid-cols-1 md:grid-cols-5 gap-3">
  <input type="search" name="q" value="{{ request.GET.q|default_if_none:'' }}" placeholder="Nom, rôle, expertise…"
         class="px-3 py-2 rounded-lg border border-slate-300 dark:border-white/10 bg-white dark:bg-slate-950">
  <input type="text" name="department" value="{{ request.GET.department|default_if_none:'' }}" placeholder="Département"
         class="px-3 py-2 rounded-lg border border-slate-300 dark:border-white/10 bg-white dark:bg-slate-950">
  <select name="seniority" class="px-3 py-2 rounded-lg border border-slate-300 dark:border-white/10 bg-white dark:bg-slate-950">
    <option value="">Séniorité</option>
    <option value="exec"   {% if request.GET.seniority == 'exec' %}selected{% endif %}>Direction</option>
    <option value="lead"   {% if request.GET.seniority == 'lead' %}selected{% endif %}>Lead</option>
    <option value="senior" {% if request.GET.seniority == 'senior' %}selected{% endif %}>Senior</option>
    <option value="mid"    {% if request.GET.seniority == 'mid' %}selected{% endif %}>Confirmé</option>
    <option value="junior" {% if request.GET.seniority == 'junior' %}selected{% endif %}>Junior</option>
  </select>
  <select name="active" class="px-3 py-2 rounded-lg border border-slate-300 dark:border-white/10 bg-white dark:bg-slate-950">
    <option value="">Actif — Tous</option>
    <option value="yes" {% if request.GET.active == 'yes' %}selected{% endif %}>Actifs</option>
    <option value="no"  {% if request.GET.active == 'no' %}selected{% endif %}>Inactifs</option>
  </select>
  <div class="md:col-span-5">
    <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Filtrer</button>
    {% if request.GET %}<a href="{{ request.path }}" class="ml-2 text-sm text-slate-600 dark:text-slate-400 hover:underline">Réinitialiser</a>{% endif %}
  </div>
</form>

<section class="bg-white dark:bg-slate-900 rounded-2xl shadow ring-1 ring-black/5 dark:ring-white/10 overflow-hidden">
  <table class="w-full text-sm">
    <thead class="bg-gray-50 dark:bg-slate-800/60">
      <tr class="text-left">
        <th class="p-3">Nom</th>
        <th class="p-3">Rôle</th>
        <th class="p-3">Département</th>
        <th class="p-3">Séniorité</th>
        <th class="p-3">Actif</th>
        <th class="p-3 text-right">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-200 dark:divide-white/10">
      {% for m in page_obj.object_list %}
      <tr>
        <td class="p-3 font-medium">{{ m.name }}</td>
        <td class="p-3">{{ m.role }}</td>
        <td class="p-3">{{ m.department|default:"-" }}</td>
        <td class="p-3">{{ m.get_seniority_display|default:"-" }}</td>
        <td class="p-3">
          {% if m.is_active %}
            <span class="px-2 py-0.5 rounded text-xs bg-emerald-50 text-emerald-700 border border-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-300 dark:border-emerald-900/40">Actif</span>
          {% else %}
            <span class="px-2 py-0.5 rounded text-xs bg-slate-100 text-slate-700 border border-slate-200 dark:bg-slate-800/60 dark:text-slate-200 dark:border-white/10">Inactif</span>
          {% endif %}
        </td>
        <td class="p-3 text-right space-x-2">
          <a href="{% url 'staff:team_detail' m.slug %}" class="text-blue-600 dark:text-blue-300 hover:underline">Détails</a>
          {% if request.user.is_superuser %}
          <a href="{% url 'staff:team_update' m.slug %}" class="text-slate-600 dark:text-slate-300 hover:underline">Éditer</a>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="6" class="p-6 text-center text-slate-500 dark:text-slate-400">Aucun membre.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</section>

{% include "staff/partials/_pagination.html" with page_obj=page_obj qs=qs_params %}
{% endblock %}
